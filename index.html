<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>PDR Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* üåø –û–±—â–∏–π —Å—Ç–∏–ª—å Apple-style */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #f5f7fa, #e4ebf0);
      margin: 0;
      padding: 40px 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      color: #1d1d1f;
    }

    .container {
      backdrop-filter: blur(15px);
      background: rgba(255, 255, 255, 0.75);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
      border-radius: 25px;
      padding: 30px 40px;
      width: 90%;
      max-width: 950px;
      transition: 0.3s ease;
    }

    h1 {
      text-align: center;
      font-weight: 600;
      font-size: 1.8rem;
      margin-bottom: 30px;
      color: #0071e3;
    }

    h2 {
      color: #0071e3;
      font-size: 1.2rem;
      font-weight: 500;
      margin-bottom: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      border-radius: 12px;
      overflow: hidden;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    th {
      background: #f5f5f7;
      color: #333;
      font-weight: 600;
      font-size: 0.9rem;
    }

    tr:nth-child(even) { background: #fafafa; }

    select, input {
      border: 1px solid #d1d1d6;
      border-radius: 8px;
      padding: 6px 10px;
      font-size: 0.9rem;
      transition: 0.2s;
    }

    select:focus, input:focus {
      outline: none;
      border-color: #0071e3;
      box-shadow: 0 0 3px rgba(0, 113, 227, 0.4);
    }

    button {
      background: #0071e3;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 8px 14px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover { background: #005bb5; }

    .element-block {
      border: 1px solid #e5e5ea;
      border-radius: 18px;
      padding: 20px;
      margin-top: 25px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .total {
      text-align: right;
      font-weight: 600;
      font-size: 1.05rem;
      margin-top: 10px;
    }

    .grand-total {
      text-align: right;
      font-weight: 700;
      font-size: 1.3rem;
      margin-top: 30px;
      color: #0071e3;
    }

    .control-bar {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 25px;
    }

    .note {
      text-align: center;
      margin-top: 20px;
      color: #555;
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üõ†Ô∏è PDR –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä </h1>

    <div id="elements"></div>

    <div class="control-bar">
      <button onclick="addElement()">+ –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</button>
      <button onclick="calculateAll()">üí∞ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
    </div>

    <div class="grand-total" id="grandTotal"></div>
    <div class="note">*–°–∫–∏–¥–∫–∞ 20% –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –±–æ–ª–µ–µ —á–µ–º 10 –≤–º—è—Ç–∏–Ω–∞—Ö –ø–æ –≤—Å–µ–º—É –∞–≤—Ç–æ.</div>
<h1>–ü–†–ò–ú–ï–† –†–ê–°–ß–Å–¢–ê –û–î–ù–û–ô –í–ú–Ø–¢–ò–ù–´</h1>
<div class="note">–í–ó–ê–í–ò–°–ò–ú–û–°–¢–ò –û–¢ –ú–ê–¢–ï–†–ò–ê–õ–ê –ö–£–ó–û–í–ê, –î–û–°–¢–£–ü–ê –ò –†–ê–ó–ë–û–†–ê –°–ê–õ–û–ù–ê</div>
<table>
  <thead>
    <tr>
      <th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th>
      <th>–í–∞—Ä–∏–∞–Ω—Ç</th>
      <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
      <th>–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ü–µ–Ω–∞</th>
      <th>–ü–æ—è—Å–Ω–µ–Ω–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞</td>
      <td>-</td>
      <td>-</td>
      <td>400 –≥—Ä–Ω</td>
      <td>–¶–µ–Ω–∞ –∑–∞ –æ–¥–Ω—É –º–∞–ª–µ–Ω—å–∫—É—é –≤–º—è—Ç–∏–Ω—É</td>
    </tr>
    <tr>
      <td>–ú–∞—Ç–µ—Ä–∏–∞–ª</td>
      <td>–°—Ç–∞–ª—å</td>
      <td>1.0</td>
      <td>400 –≥—Ä–Ω</td>
      <td>–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è</td>
    </tr>
    <tr>
      <td>–ú–∞—Ç–µ—Ä–∏–∞–ª</td>
      <td>–ê–ª—é–º–∏–Ω–∏–π</td>
      <td>1.3</td>
      <td>400 √ó 1.3 = 520 –≥—Ä–Ω</td>
      <td>+30% –∑–∞ —Å–ª–æ–∂–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</td>
    </tr>
    <tr>
      <td>–î–æ—Å—Ç—É–ø</td>
      <td>–•–æ—Ä–æ—à–∏–π</td>
      <td>1.0</td>
      <td>520 –≥—Ä–Ω</td>
      <td>–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è</td>
    </tr>
    <tr>
      <td>–î–æ—Å—Ç—É–ø</td>
      <td>–°—Ä–µ–¥–Ω–∏–π</td>
      <td>1.2</td>
      <td>520 √ó 1.2 = 624 –≥—Ä–Ω</td>
      <td>+20% –∑–∞ —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø</td>
    </tr>
    <tr>
      <td>–î–æ—Å—Ç—É–ø</td>
      <td>–ü–ª–æ—Ö–æ–π</td>
      <td>1.3</td>
      <td>520 √ó 1.3 = 676 –≥—Ä–Ω</td>
      <td>+30% –∑–∞ –ø–ª–æ—Ö–æ–π –¥–æ—Å—Ç—É–ø</td>
    </tr>
    <tr>
      <td>–ó–∞–ª–æ–º</td>
      <td>–ù–µ—Ç</td>
      <td>1.0</td>
      <td>676 –≥—Ä–Ω</td>
      <td>–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è</td>
    </tr>
    <tr>
      <td>–ó–∞–ª–æ–º</td>
      <td>–î–∞</td>
      <td>1.25</td>
      <td>676 √ó 1.25 = 845 –≥—Ä–Ω</td>
      <td>+25% –∑–∞ –∑–∞–ª–æ–º</td>
    </tr>
    <tr>
      <td>–†–∞–∑–±–æ—Ä–∫–∞</td>
      <td>–ù–µ—Ç</td>
      <td>1.0</td>
      <td>845 –≥—Ä–Ω</td>
      <td>–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è</td>
    </tr>
    <tr>
      <td>–†–∞–∑–±–æ—Ä–∫–∞</td>
      <td>–î–∞</td>
      <td>1.15</td>
      <td>845 √ó 1.15 = 972 –≥—Ä–Ω</td>
      <td>+15% –∑–∞ —Ä–∞–∑–±–æ—Ä–∫—É</td>
    </tr>
  </tbody>
</table>

  <script>
    /* === ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è ===
       –¢—ã –º–æ–∂–µ—à—å –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –±–∞–∑–æ–≤—ã–µ —Ü–µ–Ω—ã –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∑–¥–µ—Å—å ‚Üì
    */

    const basePrices = {
      small: 400,    // –¥–æ 10 –º–º
      medium: 700,   // 10‚Äì30 –º–º
      large: 1100,   // 30‚Äì50 –º–º
      xlarge: 2000,  // 50‚Äì100 –º–º
      huge: 2500     // >100 –º–º
    };

    const materialFactors = {
      steel: 1.0,
      aluminum: 1.3
    };

    const accessFactors = {
      good: 1.0,
      medium: 1.2,
      bad: 1.3
    };

    const reinforceFactors = {
      no: 1.0,
      yes: 1.25
    };

    const disassemblyFactors = {
      no: 1.0,
      yes: 1.15
    };

    let elementCount = 0;

    function addElement() {
      elementCount++;
      const container = document.getElementById("elements");

      const element = document.createElement("div");
      element.classList.add("element-block");
      element.id = `element-${elementCount}`;

      element.innerHTML = `
        <h2>–≠–ª–µ–º–µ–Ω—Ç ${elementCount}:
          <select class="element-name">
            <option>–î–≤–µ—Ä—å</option>
            <option>–ö—Ä—ã–ª–æ</option>
            <option>–ö–∞–ø–æ—Ç</option>
            <option>–ö—Ä—ã—à–∞</option>
            <option>–ë–∞–≥–∞–∂–Ω–∏–∫</option>
            <option>–ü–æ—Ä–æ–≥</option>
          </select>
          <button onclick="addDentRow('${element.id}')">+ –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</button>
          <button style="background:#ff3b30;" onclick="removeElement('${element.id}')">–£–¥–∞–ª–∏—Ç—å</button>
        </h2>

        <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
          <label>–ú–∞—Ç–µ—Ä–∏–∞–ª: 
            <select class="material">
              <option value="steel">–°—Ç–∞–ª—å</option>
              <option value="aluminum">–ê–ª—é–º–∏–Ω–∏–π</option>
            </select>
          </label>
          <label>–î–æ—Å—Ç—É–ø:
            <select class="access">
              <option value="good">–•–æ—Ä–æ—à–∏–π</option>
              <option value="medium">–°—Ä–µ–¥–Ω–∏–π +20%</option>
              <option value="bad">–ü–ª–æ—Ö–æ–π +30%</option>
            </select>
          </label>
          <label>–ó–∞–ª–æ–º:
            <select class="reinforce">
              <option value="no">–ù–µ—Ç</option>
              <option value="yes">–î–∞ +25%</option>
            </select>
          </label>
          <label>–†–∞–∑–±–æ—Ä:
            <select class="disassembly">
              <option value="no">–ù–µ—Ç</option>
              <option value="yes">–î–∞ +15%</option>
            </select>
          </label>
        </div>

        <table>
          <thead>
            <tr>
              <th>–†–∞–∑–º–µ—Ä –≤–º—è—Ç–∏–Ω</th>
              <th>–ö–æ–ª-–≤–æ</th>
              <th>–¶–µ–Ω–∞, –≥—Ä–Ω</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="total" id="element-total-${elementCount}"></div>
      `;

      container.appendChild(element);
      addDentRow(element.id);
    }

    function addDentRow(elementId) {
      const tbody = document.querySelector(`#${elementId} tbody`);
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>
          <select class="size">
            <option value="small">–¥–æ 10 –º–º (400)</option>
            <option value="medium">10‚Äì30 –º–º (700)</option>
            <option value="large">30‚Äì50 –º–º (1100)</option>
            <option value="xlarge">50‚Äì100 –º–º (2000)</option>
            <option value="huge">>100 –º–º (2500)</option>
          </select>
        </td>
        <td><input type="number" class="count" value="1" min="1" style="width:60px"></td>
        <td class="price">0</td>
        <td><button style="background:#ff3b30;" onclick="this.closest('tr').remove(); calculateAll();">‚úñ</button></td>
      `;

      tbody.appendChild(row);
    }

    function removeElement(id) {
      document.getElementById(id).remove();
      calculateAll();
    }

    function calculateAll() {
      const elements = document.querySelectorAll(".element-block");
      let totalAuto = 0;
      let totalDents = 0;

      elements.forEach((element, i) => {
        const material = materialFactors[element.querySelector(".material").value];
        const access = accessFactors[element.querySelector(".access").value];
        const reinforce = reinforceFactors[element.querySelector(".reinforce").value];
        const disassembly = disassemblyFactors[element.querySelector(".disassembly").value];

        let elementTotal = 0;
        const rows = element.querySelectorAll("tbody tr");

        rows.forEach(row => {
          const size = basePrices[row.querySelector(".size").value];
          const count = parseInt(row.querySelector(".count").value);
          const price = size * count * material * access * reinforce * disassembly;
          row.querySelector(".price").textContent = price.toFixed(0);

          elementTotal += price;
          totalDents += count;
        });

        totalAuto += elementTotal;
        document.getElementById(`element-total-${i+1}`).textContent = 
          `–ò—Ç–æ–≥–æ –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É: ${elementTotal.toFixed(0)} –≥—Ä–Ω`;
      });

      let discount = totalDents > 10 ? 0.8 : 1.0;
      let discountedTotal = totalAuto * discount;

      document.getElementById("grandTotal").innerHTML = `
        –í—Å–µ–≥–æ –≤–º—è—Ç–∏–Ω: ${totalDents} —à—Ç<br>
        –û–±—â–∞—è —Å—É–º–º–∞: ${totalAuto.toFixed(0)} –≥—Ä–Ω<br>
        ${discount < 1 ? "–°–∫–∏–¥–∫–∞ 20% –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ üéâ<br>" : ""}
        <strong>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ: ${discountedTotal.toFixed(0)} –≥—Ä–Ω</strong>
      `;
    }

    window.onload = () => addElement();
  </script>
</body>
</html>
